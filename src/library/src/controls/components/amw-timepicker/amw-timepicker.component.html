<div class="amw-timepicker" [class]="'amw-timepicker--' + size() + ' amw-timepicker--' + color()">
  <mat-form-field [appearance]="config().appearance || 'outline'" [class]="'mat-form-field--' + color()">
    @if (label()) {
      <mat-label>{{ label() }}</mat-label>
    }

    <input
      matInput
      [value]="timeValue()"
      [placeholder]="placeholder()"
      [disabled]="isDisabled"
      [required]="required()"
      readonly
      (click)="toggleTimepicker()"
      (focus)="onFocus($event)"
      (blur)="onBlur($event)"
      />

    <amw-button
      variant="icon"
      icon="access_time"
      matSuffix
      type="button"
      [disabled]="isDisabled"
      (click)="toggleTimepicker()"
      aria-label="Open time picker">
    </amw-button>

    @if (hasValidationError) {
      <mat-error>
        {{ errorText }}
      </mat-error>
    }
  </mat-form-field>

  <!-- Time Picker Dropdown -->
  @if (isOpen()) {
    <div class="amw-timepicker__dropdown" (click)="$event.stopPropagation()">
      <div class="amw-timepicker__header">
        <span class="amw-timepicker__title">Select Time</span>
        <amw-button variant="icon" icon="close" (click)="isOpen.set(false)" aria-label="Close">
        </amw-button>
      </div>
      <div class="amw-timepicker__content">
        <!-- Hours -->
        <div class="amw-timepicker__section">
          <div class="amw-timepicker__label">Hours</div>
          <div class="amw-timepicker__controls">
            <amw-button variant="icon" icon="keyboard_arrow_up" (click)="incrementHours()" [disabled]="isDisabled">
            </amw-button>
            <div class="amw-timepicker__value">{{ displayHours.toString().padStart(2, '0') }}</div>
            <amw-button variant="icon" icon="keyboard_arrow_down" (click)="decrementHours()" [disabled]="isDisabled">
            </amw-button>
          </div>
        </div>
        <!-- Minutes -->
        <div class="amw-timepicker__section">
          <div class="amw-timepicker__label">Minutes</div>
          <div class="amw-timepicker__controls">
            <amw-button variant="icon" icon="keyboard_arrow_up" (click)="incrementMinutes()" [disabled]="isDisabled">
            </amw-button>
            <div class="amw-timepicker__value">{{ minutes().toString().padStart(2, '0') }}</div>
            <amw-button variant="icon" icon="keyboard_arrow_down" (click)="decrementMinutes()" [disabled]="isDisabled">
            </amw-button>
          </div>
        </div>
        <!-- Seconds (if enabled) -->
        @if (showSeconds()) {
          <div class="amw-timepicker__section">
            <div class="amw-timepicker__label">Seconds</div>
            <div class="amw-timepicker__controls">
              <amw-button variant="icon" icon="keyboard_arrow_up" (click)="incrementSeconds()" [disabled]="isDisabled">
              </amw-button>
              <div class="amw-timepicker__value">{{ seconds().toString().padStart(2, '0') }}</div>
              <amw-button variant="icon" icon="keyboard_arrow_down" (click)="decrementSeconds()" [disabled]="isDisabled">
              </amw-button>
            </div>
          </div>
        }
        <!-- AM/PM (if 12h format) -->
        @if (format() === '12h') {
          <div class="amw-timepicker__section">
            <div class="amw-timepicker__label">Period</div>
            <div class="amw-timepicker__controls">
              <amw-button
                variant="text"
                [class]="'amw-timepicker__ampm amw-timepicker__ampm--' + (ampm() === 'AM' ? 'active' : 'inactive')"
                (click)="toggleAmPm()"
                [disabled]="isDisabled">
                {{ ampm() }}
              </amw-button>
            </div>
          </div>
        }
      </div>
      <div class="amw-timepicker__actions">
        <amw-button variant="text" (click)="isOpen.set(false)">Cancel</amw-button>
        <amw-button variant="text" color="primary" (click)="selectTime(hours(), minutes(), seconds())">OK</amw-button>
      </div>
    </div>
  }
</div>