<mat-card
  [class]="cardClasses()"
  [style]="cardStyles()"
  [attr.aria-disabled]="disabled()"
  [attr.aria-busy]="loading()">

  <!-- Clickable wrapper -->
  @if (clickable()) {
    <div
      (click)="onCardClick()"
      class="amw-card__ripple-container"
      role="button"
      tabindex="0">

      <!-- Card Image -->
      @if (hasImage() && imagePosition() === 'top') {
        <img
          mat-card-image
          [src]="image()"
          [alt]="imageAlt()"
          [class]="imageClasses">
      }

      <!-- Card Header -->
      @if (hasHeader()) {
        <mat-card-header>
          @if (headerTemplate()) {
            <ng-container [ngTemplateOutlet]="headerTemplate()!"></ng-container>
          } @else {
            <ng-container>
              @if (headerIcon()) {
                <div mat-card-avatar class="amw-card__avatar">
                  <amw-icon [name]="headerIcon()"></amw-icon>
                </div>
              }
              <mat-card-title>{{ headerTitle() }}</mat-card-title>
              @if (headerSubtitle()) {
                <mat-card-subtitle>{{ headerSubtitle() }}</mat-card-subtitle>
              }
            </ng-container>
          }
        </mat-card-header>
      }

      <!-- Card Content -->
      @if (hasContent()) {
        <mat-card-content>
          @if (contentTemplate()) {
            <ng-container [ngTemplateOutlet]="contentTemplate()!"></ng-container>
          } @else {
            <p class="amw-card__content-text">{{ content() }}</p>
          }
        </mat-card-content>
      }

      <!-- Card Image (bottom) -->
      @if (hasImage() && imagePosition() === 'bottom') {
        <img
          mat-card-image
          [src]="image()"
          [alt]="imageAlt()"
          [class]="imageClasses">
      }

      <!-- Card Actions -->
      @if (hasActions()) {
        <mat-card-actions [align]="actionAlignment">
          @if (actionTemplate()) {
            <ng-container [ngTemplateOutlet]="actionTemplate()!"></ng-container>
          } @else {
            @for (action of actions(); track action; let i = $index) {
              <amw-button
                appearance="text"
                [icon]="action.icon"
                [iconPosition]="'left'"
                [color]="action.color || 'primary'"
                [disabled]="action.disabled || disabled() || loading()"
                (click)="onActionClick(action, i, $event)"
                class="amw-card__action">
                {{ action.label }}
              </amw-button>
            }
          }
        </mat-card-actions>
      }

      <!-- Card Footer -->
      @if (hasFooter()) {
        <mat-card-footer>
          @if (footerTemplate()) {
            <ng-container [ngTemplateOutlet]="footerTemplate()!"></ng-container>
          } @else {
            <p class="amw-card__footer-text">{{ footerContent() }}</p>
          }
        </mat-card-footer>
      }

    </div>
  } @else {
    <!-- Non-clickable content -->
    <!-- Card Image -->
    @if (hasImage() && imagePosition() === 'top') {
      <img
        mat-card-image
        [src]="image()"
        [alt]="imageAlt()"
        [class]="imageClasses">
    }

    <!-- Card Header -->
    @if (hasHeader()) {
      <mat-card-header>
        @if (headerTemplate()) {
          <ng-container [ngTemplateOutlet]="headerTemplate()!"></ng-container>
        } @else {
          <ng-container>
            @if (headerIcon()) {
              <div mat-card-avatar class="amw-card__avatar">
                <amw-icon [name]="headerIcon()"></amw-icon>
              </div>
            }
            <mat-card-title>{{ headerTitle() }}</mat-card-title>
            @if (headerSubtitle()) {
              <mat-card-subtitle>{{ headerSubtitle() }}</mat-card-subtitle>
            }
          </ng-container>
        }
      </mat-card-header>
    }

    <!-- Card Content -->
    @if (hasContent()) {
      <mat-card-content>
        @if (contentTemplate()) {
          <ng-container [ngTemplateOutlet]="contentTemplate()!"></ng-container>
        } @else {
          <p class="amw-card__content-text">{{ content() }}</p>
        }
      </mat-card-content>
    }

    <!-- Card Image (bottom) -->
    @if (hasImage() && imagePosition() === 'bottom') {
      <img
        mat-card-image
        [src]="image()"
        [alt]="imageAlt()"
        [class]="imageClasses">
    }

    <!-- Card Actions -->
    @if (hasActions()) {
      <mat-card-actions [align]="actionAlignment">
        @if (actionTemplate()) {
          <ng-container [ngTemplateOutlet]="actionTemplate()!"></ng-container>
        } @else {
          @for (action of actions(); track action; let i = $index) {
            <amw-button
              appearance="text"
              [icon]="action.icon"
              [iconPosition]="'left'"
              [color]="action.color || 'primary'"
              [disabled]="action.disabled || disabled() || loading()"
              (click)="onActionClick(action, i, $event)"
              class="amw-card__action">
              {{ action.label }}
            </amw-button>
          }
        }
      </mat-card-actions>
    }

    <!-- Card Footer -->
    @if (hasFooter()) {
      <mat-card-footer>
        @if (footerTemplate()) {
          <ng-container [ngTemplateOutlet]="footerTemplate()!"></ng-container>
        } @else {
          <p class="amw-card__footer-text">{{ footerContent() }}</p>
        }
      </mat-card-footer>
    }
  }

  <!-- Loading Overlay -->
  @if (loading()) {
    <div class="amw-card__loading">
      <amw-progress-spinner [diameter]="40"></amw-progress-spinner>
      <p>Loading...</p>
    </div>
  }
</mat-card>
