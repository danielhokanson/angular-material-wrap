<div class="amw-theme-editor">
  <!-- Theme Form -->
  <amw-card class="theme-form-card">
    <ng-template #cardHeader>
      <amw-icon name="palette"></amw-icon>
      {{ isEditing() ? 'Edit Theme' : 'Create New Theme' }}
      <p>{{ isEditing() ? 'Modify an existing custom theme' : 'Design a custom theme with your own colors' }}</p>
    </ng-template>

    <ng-template #cardContent>
      <div class="theme-form">
        <!-- Basic Info -->
        <div class="form-section">
          <h3>Basic Information</h3>
          <div class="form-row">
            <amw-input
              label="Theme Name"
              [(ngModel)]="themeName"
              (ngModelChange)="onThemeNameChange()"
              placeholder="My Custom Theme"
              [required]="true"
              appearance="outline"
              class="form-field">
            </amw-input>

            <amw-input
              label="Theme ID"
              [(ngModel)]="themeId"
              placeholder="my-custom-theme"
              [required]="true"
              hint="Used internally (auto-generated from name)"
              appearance="outline"
              class="form-field">
            </amw-input>
          </div>

          <div class="form-row">
            <amw-switch
              [(checked)]="isDarkMode"
              (switchChange)="onDarkModeChanged($event)"
              label="Dark Mode"
              class="dark-mode-toggle">
            </amw-switch>
          </div>
        </div>

        <amw-divider></amw-divider>

        <!-- Color Palette -->
        <div class="form-section">
          <h3>Color Palette</h3>
          <div class="color-grid">
            <div class="color-item">
              <amw-color-picker
                label="Primary Color"
                [(ngModel)]="colors.primary"
                (colorChange)="onColorChange('primary', $event)"
                [showInput]="true"
                [showPreview]="true"
                [showPalette]="true"
                class="color-field">
              </amw-color-picker>
            </div>

            <div class="color-item">
              <amw-color-picker
                label="Accent Color"
                [(ngModel)]="colors.accent"
                (colorChange)="onColorChange('accent', $event)"
                [showInput]="true"
                [showPreview]="true"
                [showPalette]="true"
                class="color-field">
              </amw-color-picker>
            </div>

            <div class="color-item">
              <amw-color-picker
                label="Warn Color"
                [(ngModel)]="colors.warn"
                (colorChange)="onColorChange('warn', $event)"
                [showInput]="true"
                [showPreview]="true"
                [showPalette]="true"
                class="color-field">
              </amw-color-picker>
            </div>

            <div class="color-item">
              <amw-color-picker
                label="Background Color"
                [(ngModel)]="colors.background"
                (colorChange)="onColorChange('background', $event)"
                [showInput]="true"
                [showPreview]="true"
                [showPalette]="true"
                class="color-field">
              </amw-color-picker>
            </div>

            <div class="color-item">
              <amw-color-picker
                label="Surface Color"
                [(ngModel)]="colors.surface"
                (colorChange)="onColorChange('surface', $event)"
                [showInput]="true"
                [showPreview]="true"
                [showPalette]="true"
                class="color-field">
              </amw-color-picker>
            </div>

            <div class="color-item">
              <amw-color-picker
                label="Foreground Color"
                [(ngModel)]="colors.foreground"
                (colorChange)="onColorChange('foreground', $event)"
                [showInput]="true"
                [showPreview]="true"
                [showPalette]="true"
                class="color-field">
              </amw-color-picker>
            </div>
          </div>
        </div>

        <amw-divider></amw-divider>

        <!-- Actions -->
        <div class="form-actions">
          <amw-button
            appearance="elevated"
            icon="save"
            iconPosition="left"
            color="primary"
            (click)="onSaveTheme()"
            [disabled]="!isValid">
            {{ isEditing() ? 'Update Theme' : 'Create Theme' }}
          </amw-button>

          <amw-button
            appearance="text"
            icon="visibility"
            iconPosition="left"
            (click)="onPreviewTheme()"
            [disabled]="!isValid">
            Preview
          </amw-button>

          <amw-button
            appearance="text"
            icon="add"
            iconPosition="left"
            (click)="onNewTheme()">
            New Theme
          </amw-button>
        </div>
      </div>
    </ng-template>
  </amw-card>

  <!-- Custom Themes List -->
  @if (customThemes().length > 0) {
    <amw-card class="themes-list-card">
      <ng-template #cardHeader>
        <amw-icon name="palette"></amw-icon>
        Custom Themes
        <p>Manage your custom themes</p>
      </ng-template>
      <ng-template #cardContent>
        <div class="themes-list">
          @for (theme of customThemes(); track theme) {
            <div class="theme-item">
              <div class="theme-info">
                <div class="theme-name">{{ theme.displayName }}</div>
                <div class="theme-meta">
                  {{ theme.isDark ? 'Dark' : 'Light' }} theme â€¢ ID: {{ theme.id }}
                </div>
              </div>
              <div class="theme-colors">
                <div
                  class="color-swatch"
                  [style.background-color]="theme.colors.primary"
                  amwTooltip="Primary">
                </div>
                <div
                  class="color-swatch"
                  [style.background-color]="theme.colors.accent"
                  amwTooltip="Accent">
                </div>
                <div
                  class="color-swatch"
                  [style.background-color]="theme.colors.warn"
                  amwTooltip="Warn">
                </div>
              </div>
              <div class="theme-actions">
                <amw-button
                                    icon="edit"
                  (click)="onLoadTheme(theme)"
                  amwTooltip="Edit theme">
                </amw-button>
                <amw-button
                                    icon="delete"
                  (click)="onDeleteTheme(theme)"
                  amwTooltip="Delete theme">
                </amw-button>
              </div>
            </div>
          }
        </div>
      </ng-template>
    </amw-card>
  }
</div>
