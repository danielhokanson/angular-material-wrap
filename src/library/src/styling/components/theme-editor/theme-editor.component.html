<div class="amw-theme-editor">
  <!-- Theme Form -->
  <mat-card class="theme-form-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>palette</mat-icon>
        {{ isEditing() ? 'Edit Theme' : 'Create New Theme' }}
      </mat-card-title>
      <mat-card-subtitle>
        {{ isEditing() ? 'Modify an existing custom theme' : 'Design a custom theme with your own colors' }}
      </mat-card-subtitle>
    </mat-card-header>
    
    <mat-card-content>
      <div class="theme-form">
        <!-- Basic Info -->
        <div class="form-section">
          <h3>Basic Information</h3>
          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Theme Name</mat-label>
              <input 
                matInput 
                [(ngModel)]="themeName" 
                (ngModelChange)="onThemeNameChange()"
                placeholder="My Custom Theme"
                required>
            </mat-form-field>
            
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Theme ID</mat-label>
              <input 
                matInput 
                [(ngModel)]="themeId" 
                placeholder="my-custom-theme"
                required>
              <mat-hint>Used internally (auto-generated from name)</mat-hint>
            </mat-form-field>
          </div>
          
          <div class="form-row">
            <mat-slide-toggle 
              [(ngModel)]="isDarkMode" 
              (change)="onDarkModeToggle()"
              class="dark-mode-toggle">
              <mat-icon>dark_mode</mat-icon>
              Dark Mode
            </mat-slide-toggle>
          </div>
        </div>

        <mat-divider></mat-divider>

        <!-- Color Palette -->
        <div class="form-section">
          <h3>Color Palette</h3>
          <div class="color-grid">
            <div class="color-item">
              <mat-form-field appearance="outline" class="color-field">
                <mat-label>Primary Color</mat-label>
                <input 
                  matInput 
                  [(ngModel)]="colors.primary" 
                  (ngModelChange)="onColorChange('primary', $event)"
                  placeholder="#673AB7"
                  pattern="^#[0-9A-Fa-f]{6}$">
                <div class="color-preview" [style.background-color]="colors.primary">
                  <span class="color-text" [style.color]="getColorContrast(colors.primary)">Aa</span>
                </div>
              </mat-form-field>
            </div>
            
            <div class="color-item">
              <mat-form-field appearance="outline" class="color-field">
                <mat-label>Accent Color</mat-label>
                <input 
                  matInput 
                  [(ngModel)]="colors.accent" 
                  (ngModelChange)="onColorChange('accent', $event)"
                  placeholder="#FFC107"
                  pattern="^#[0-9A-Fa-f]{6}$">
                <div class="color-preview" [style.background-color]="colors.accent">
                  <span class="color-text" [style.color]="getColorContrast(colors.accent)">Aa</span>
                </div>
              </mat-form-field>
            </div>
            
            <div class="color-item">
              <mat-form-field appearance="outline" class="color-field">
                <mat-label>Warn Color</mat-label>
                <input 
                  matInput 
                  [(ngModel)]="colors.warn" 
                  (ngModelChange)="onColorChange('warn', $event)"
                  placeholder="#F44336"
                  pattern="^#[0-9A-Fa-f]{6}$">
                <div class="color-preview" [style.background-color]="colors.warn">
                  <span class="color-text" [style.color]="getColorContrast(colors.warn)">Aa</span>
                </div>
              </mat-form-field>
            </div>
            
            <div class="color-item">
              <mat-form-field appearance="outline" class="color-field">
                <mat-label>Background Color</mat-label>
                <input 
                  matInput 
                  [(ngModel)]="colors.background" 
                  (ngModelChange)="onColorChange('background', $event)"
                  placeholder="#FAFAFA"
                  pattern="^#[0-9A-Fa-f]{6}$">
                <div class="color-preview" [style.background-color]="colors.background">
                  <span class="color-text" [style.color]="getColorContrast(colors.background)">Aa</span>
                </div>
              </mat-form-field>
            </div>
            
            <div class="color-item">
              <mat-form-field appearance="outline" class="color-field">
                <mat-label>Surface Color</mat-label>
                <input 
                  matInput 
                  [(ngModel)]="colors.surface" 
                  (ngModelChange)="onColorChange('surface', $event)"
                  placeholder="#FFFFFF"
                  pattern="^#[0-9A-Fa-f]{6}$">
                <div class="color-preview" [style.background-color]="colors.surface">
                  <span class="color-text" [style.color]="getColorContrast(colors.surface)">Aa</span>
                </div>
              </mat-form-field>
            </div>
            
            <div class="color-item">
              <mat-form-field appearance="outline" class="color-field">
                <mat-label>Foreground Color</mat-label>
                <input 
                  matInput 
                  [(ngModel)]="colors.foreground" 
                  (ngModelChange)="onColorChange('foreground', $event)"
                  placeholder="#212121"
                  pattern="^#[0-9A-Fa-f]{6}$">
                <div class="color-preview" [style.background-color]="colors.foreground">
                  <span class="color-text" [style.color]="getColorContrast(colors.foreground)">Aa</span>
                </div>
              </mat-form-field>
            </div>
          </div>
        </div>

        <mat-divider></mat-divider>

        <!-- Actions -->
        <div class="form-actions">
          <button 
            mat-raised-button 
            color="primary" 
            (click)="onSaveTheme()" 
            [disabled]="!isValid">
            <mat-icon>save</mat-icon>
            {{ isEditing() ? 'Update Theme' : 'Create Theme' }}
          </button>
          
          <button 
            mat-button 
            (click)="onPreviewTheme()" 
            [disabled]="!isValid">
            <mat-icon>visibility</mat-icon>
            Preview
          </button>
          
          <button 
            mat-button 
            (click)="onNewTheme()">
            <mat-icon>add</mat-icon>
            New Theme
          </button>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Custom Themes List -->
  <mat-card *ngIf="customThemes().length > 0" class="themes-list-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>palette</mat-icon>
        Custom Themes
      </mat-card-title>
      <mat-card-subtitle>Manage your custom themes</mat-card-subtitle>
    </mat-card-header>
    
    <mat-card-content>
      <div class="themes-list">
        <div *ngFor="let theme of customThemes()" class="theme-item">
          <div class="theme-info">
            <div class="theme-name">{{ theme.displayName }}</div>
            <div class="theme-meta">
              {{ theme.isDark ? 'Dark' : 'Light' }} theme â€¢ ID: {{ theme.id }}
            </div>
          </div>
          
          <div class="theme-colors">
            <div 
              class="color-swatch" 
              [style.background-color]="theme.colors.primary"
              matTooltip="Primary">
            </div>
            <div 
              class="color-swatch" 
              [style.background-color]="theme.colors.accent"
              matTooltip="Accent">
            </div>
            <div 
              class="color-swatch" 
              [style.background-color]="theme.colors.warn"
              matTooltip="Warn">
            </div>
          </div>
          
          <div class="theme-actions">
            <button 
              mat-icon-button 
              (click)="onLoadTheme(theme)"
              matTooltip="Edit theme">
              <mat-icon>edit</mat-icon>
            </button>
            <button 
              mat-icon-button 
              (click)="onDeleteTheme(theme)"
              matTooltip="Delete theme">
              <mat-icon>delete</mat-icon>
            </button>
          </div>
        </div>
      </div>
    </mat-card-content>
  </mat-card>
</div>
