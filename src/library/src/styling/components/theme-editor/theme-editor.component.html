<div class="amw-theme-editor">
  <!-- Theme Form -->
  <mat-card class="theme-form-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>palette</mat-icon>
        {{ isEditing() ? 'Edit Theme' : 'Create New Theme' }}
      </mat-card-title>
      <mat-card-subtitle>
        {{ isEditing() ? 'Modify an existing custom theme' : 'Design a custom theme with your own colors' }}
      </mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <div class="theme-form">
        <!-- Basic Info -->
        <div class="form-section">
          <h3>Basic Information</h3>
          <div class="form-row">
            <amw-input
              label="Theme Name"
              [(ngModel)]="themeName"
              (ngModelChange)="onThemeNameChange()"
              placeholder="My Custom Theme"
              required
              appearance="outline"
              class="form-field">
            </amw-input>

            <amw-input
              label="Theme ID"
              [(ngModel)]="themeId"
              placeholder="my-custom-theme"
              required
              hint="Used internally (auto-generated from name)"
              appearance="outline"
              class="form-field">
            </amw-input>
          </div>

          <div class="form-row">
            <mat-slide-toggle
              [(ngModel)]="isDarkMode"
              (change)="onDarkModeToggle()"
              class="dark-mode-toggle">
              <mat-icon>dark_mode</mat-icon>
              Dark Mode
            </mat-slide-toggle>
          </div>
        </div>

        <amw-divider></amw-divider>

        <!-- Color Palette -->
        <div class="form-section">
          <h3>Color Palette</h3>
          <div class="color-grid">
            <div class="color-item">
              <amw-input
                label="Primary Color"
                [(ngModel)]="colors.primary"
                (ngModelChange)="onColorChange('primary', $event)"
                placeholder="#673AB7"
                pattern="^#[0-9A-Fa-f]{6}$"
                appearance="outline"
                class="color-field">
                <div class="color-preview" [style.background-color]="colors.primary">
                  <span class="color-text" [style.color]="getColorContrast(colors.primary)">Aa</span>
                </div>
              </amw-input>
            </div>

            <div class="color-item">
              <amw-input
                label="Accent Color"
                [(ngModel)]="colors.accent"
                (ngModelChange)="onColorChange('accent', $event)"
                placeholder="#FFC107"
                pattern="^#[0-9A-Fa-f]{6}$"
                appearance="outline"
                class="color-field">
                <div class="color-preview" [style.background-color]="colors.accent">
                  <span class="color-text" [style.color]="getColorContrast(colors.accent)">Aa</span>
                </div>
              </amw-input>
            </div>

            <div class="color-item">
              <amw-input
                label="Warn Color"
                [(ngModel)]="colors.warn"
                (ngModelChange)="onColorChange('warn', $event)"
                placeholder="#F44336"
                pattern="^#[0-9A-Fa-f]{6}$"
                appearance="outline"
                class="color-field">
                <div class="color-preview" [style.background-color]="colors.warn">
                  <span class="color-text" [style.color]="getColorContrast(colors.warn)">Aa</span>
                </div>
              </amw-input>
            </div>

            <div class="color-item">
              <amw-input
                label="Background Color"
                [(ngModel)]="colors.background"
                (ngModelChange)="onColorChange('background', $event)"
                placeholder="#FAFAFA"
                pattern="^#[0-9A-Fa-f]{6}$"
                appearance="outline"
                class="color-field">
                <div class="color-preview" [style.background-color]="colors.background">
                  <span class="color-text" [style.color]="getColorContrast(colors.background)">Aa</span>
                </div>
              </amw-input>
            </div>

            <div class="color-item">
              <amw-input
                label="Surface Color"
                [(ngModel)]="colors.surface"
                (ngModelChange)="onColorChange('surface', $event)"
                placeholder="#FFFFFF"
                pattern="^#[0-9A-Fa-f]{6}$"
                appearance="outline"
                class="color-field">
                <div class="color-preview" [style.background-color]="colors.surface">
                  <span class="color-text" [style.color]="getColorContrast(colors.surface)">Aa</span>
                </div>
              </amw-input>
            </div>

            <div class="color-item">
              <amw-input
                label="Foreground Color"
                [(ngModel)]="colors.foreground"
                (ngModelChange)="onColorChange('foreground', $event)"
                placeholder="#212121"
                pattern="^#[0-9A-Fa-f]{6}$"
                appearance="outline"
                class="color-field">
                <div class="color-preview" [style.background-color]="colors.foreground">
                  <span class="color-text" [style.color]="getColorContrast(colors.foreground)">Aa</span>
                </div>
              </amw-input>
            </div>
          </div>
        </div>

        <amw-divider></amw-divider>

        <!-- Actions -->
        <div class="form-actions">
          <amw-button
            variant="elevated"
            icon="save"
            iconPosition="left"
            color="primary"
            (click)="onSaveTheme()"
            [disabled]="!isValid">
            {{ isEditing() ? 'Update Theme' : 'Create Theme' }}
          </amw-button>

          <amw-button
            variant="text"
            icon="visibility"
            iconPosition="left"
            (click)="onPreviewTheme()"
            [disabled]="!isValid">
            Preview
          </amw-button>

          <amw-button
            variant="text"
            icon="add"
            iconPosition="left"
            (click)="onNewTheme()">
            New Theme
          </amw-button>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Custom Themes List -->
  @if (customThemes().length > 0) {
    <mat-card class="themes-list-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>palette</mat-icon>
          Custom Themes
        </mat-card-title>
        <mat-card-subtitle>Manage your custom themes</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <div class="themes-list">
          @for (theme of customThemes(); track theme) {
            <div class="theme-item">
              <div class="theme-info">
                <div class="theme-name">{{ theme.displayName }}</div>
                <div class="theme-meta">
                  {{ theme.isDark ? 'Dark' : 'Light' }} theme â€¢ ID: {{ theme.id }}
                </div>
              </div>
              <div class="theme-colors">
                <div
                  class="color-swatch"
                  [style.background-color]="theme.colors.primary"
                  amwTooltip="Primary">
                </div>
                <div
                  class="color-swatch"
                  [style.background-color]="theme.colors.accent"
                  amwTooltip="Accent">
                </div>
                <div
                  class="color-swatch"
                  [style.background-color]="theme.colors.warn"
                  amwTooltip="Warn">
                </div>
              </div>
              <div class="theme-actions">
                <amw-button
                  variant="icon"
                  icon="edit"
                  (click)="onLoadTheme(theme)"
                  amwTooltip="Edit theme">
                </amw-button>
                <amw-button
                  variant="icon"
                  icon="delete"
                  (click)="onDeleteTheme(theme)"
                  amwTooltip="Delete theme">
                </amw-button>
              </div>
            </div>
          }
        </div>
      </mat-card-content>
    </mat-card>
  }
</div>
