<div class="validation-section">
  <h3>Form Validation Examples</h3>
  <p>Multi-step form using tabs with validation, progress tracking, and error handling.</p>

  <div class="validation-forms">
    <amw-card class="validation-card">
      <ng-template #cardHeader>
        <h2>
          <amw-icon name="fact_check"></amw-icon>
          Multi-Step Registration Form
        </h2>
        <p class="subtitle">Complete all steps to submit the form</p>
      </ng-template>
      <ng-template #cardContent>
        <amw-tabs [(selectedIndex)]="selectedTabIndex" class="registration-tabs">
          <!-- Step 1: Personal Info -->
          <amw-tab>
            <ng-template mat-tab-label>
              <div class="tab-label" [ngClass]="getStepClass(0)">
                <amw-icon [name]="getStepIcon(0)"></amw-icon>
                <span>{{ steps[0].label }}</span>
              </div>
      </ng-template>
            <div class="tab-content">
              <h4>Step 1: Personal Information</h4>
              <form [formGroup]="personalInfoForm">
                <div class="form-row">
                  <amw-input
                    class="half-width"
                    label="First Name"
                    formControlName="firstName"
                    placeholder="John">
                  </amw-input>
                  @if (personalInfoForm.get('firstName')?.invalid && personalInfoForm.get('firstName')?.touched) {
                    <div class="field-error">{{ getErrorMessage(personalInfoForm, 'firstName') }}</div>
                  }

                  <amw-input
                    class="half-width"
                    label="Last Name"
                    formControlName="lastName"
                    placeholder="Doe">
                  </amw-input>
                  @if (personalInfoForm.get('lastName')?.invalid && personalInfoForm.get('lastName')?.touched) {
                    <div class="field-error">{{ getErrorMessage(personalInfoForm, 'lastName') }}</div>
                  }
                </div>

                <amw-input
                  class="full-width"
                  label="Email"
                  formControlName="email"
                  type="email"
                  placeholder="john.doe@example.com">
                </amw-input>
                @if (personalInfoForm.get('email')?.invalid && personalInfoForm.get('email')?.touched) {
                  <div class="field-error">{{ getErrorMessage(personalInfoForm, 'email') }}</div>
                }

                <amw-input
                  class="full-width"
                  label="Phone Number"
                  formControlName="phone"
                  placeholder="1234567890"
                  hint="Enter 10 digits without spaces or dashes">
                </amw-input>
                @if (personalInfoForm.get('phone')?.invalid && personalInfoForm.get('phone')?.touched) {
                  <div class="field-error">{{ getErrorMessage(personalInfoForm, 'phone') }}</div>
                }
              </form>
            </div>
          </amw-tab>

          <!-- Step 2: Account Details -->
          <amw-tab>
            <ng-template mat-tab-label>
              <div class="tab-label" [ngClass]="getStepClass(1)">
                <amw-icon [name]="getStepIcon(1)"></amw-icon>
                <span>{{ steps[1].label }}</span>
              </div>
            </ng-template>
            <div class="tab-content">
              <h4>Step 2: Account Details</h4>
              <form [formGroup]="accountDetailsForm">
                <amw-input
                  class="full-width"
                  label="Username"
                  formControlName="username"
                  placeholder="johndoe"
                  hint="Minimum 4 characters">
                </amw-input>
                @if (accountDetailsForm.get('username')?.invalid && accountDetailsForm.get('username')?.touched) {
                  <div class="field-error">{{ getErrorMessage(accountDetailsForm, 'username') }}</div>
                }

                <amw-input
                  class="full-width"
                  label="Password"
                  formControlName="password"
                  type="password"
                  hint="Minimum 8 characters">
                </amw-input>
                @if (accountDetailsForm.get('password')?.invalid && accountDetailsForm.get('password')?.touched) {
                  <div class="field-error">{{ getErrorMessage(accountDetailsForm, 'password') }}</div>
                }

                <amw-input
                  class="full-width"
                  label="Confirm Password"
                  formControlName="confirmPassword"
                  type="password">
                </amw-input>
                @if (accountDetailsForm.get('confirmPassword')?.invalid && accountDetailsForm.get('confirmPassword')?.touched) {
                  <div class="field-error">{{ getErrorMessage(accountDetailsForm, 'confirmPassword') }}</div>
                }

                <!-- Form-level validation using AMW -->
                <amw-form-validation
                  [form]="accountDetailsForm"
                  [errors]="accountDetailsValidation"
                  displayMode="inline"
                  position="bottom">
                </amw-form-validation>
              </form>
            </div>
          </amw-tab>

          <!-- Step 3: Preferences -->
          <amw-tab>
            <ng-template mat-tab-label>
              <div class="tab-label" [ngClass]="getStepClass(2)">
                <amw-icon [name]="getStepIcon(2)"></amw-icon>
                <span>{{ steps[2].label }}</span>
              </div>
            </ng-template>
            <div class="tab-content">
              <h4>Step 3: Preferences</h4>
              <form [formGroup]="preferencesForm">
                <amw-select
                  class="full-width"
                  label="Language"
                  formControlName="language"
                  [options]="languageOptions">
                </amw-select>
                @if (preferencesForm.get('language')?.invalid && preferencesForm.get('language')?.touched) {
                  <div class="field-error">{{ getErrorMessage(preferencesForm, 'language') }}</div>
                }

                <amw-select
                  class="full-width"
                  label="Timezone"
                  formControlName="timezone"
                  [options]="timezoneOptions">
                </amw-select>
                @if (preferencesForm.get('timezone')?.invalid && preferencesForm.get('timezone')?.touched) {
                  <div class="field-error">{{ getErrorMessage(preferencesForm, 'timezone') }}</div>
                }

                <amw-select
                  class="full-width"
                  label="Notification Preference"
                  formControlName="notifications"
                  [options]="notificationOptions">
                </amw-select>
              </form>
            </div>
          </amw-tab>

          <!-- Step 4: Review -->
          <amw-tab>
            <ng-template mat-tab-label>
              <div class="tab-label" [ngClass]="getStepClass(3)">
                <amw-icon [name]="getStepIcon(3)"></amw-icon>
                <span>{{ steps[3].label }}</span>
              </div>
            </ng-template>
            <div class="tab-content">
              <h4>Step 4: Review & Submit</h4>

              <div class="review-section">
                <h5>Personal Information</h5>
                <div class="review-item">
                  <span class="review-label">Name:</span>
                  <span>{{ personalInfoForm.get('firstName')?.value }} {{ personalInfoForm.get('lastName')?.value }}</span>
                </div>
                <div class="review-item">
                  <span class="review-label">Email:</span>
                  <span>{{ personalInfoForm.get('email')?.value }}</span>
                </div>
                <div class="review-item">
                  <span class="review-label">Phone:</span>
                  <span>{{ personalInfoForm.get('phone')?.value }}</span>
                </div>
              </div>

              <div class="review-section">
                <h5>Account Details</h5>
                <div class="review-item">
                  <span class="review-label">Username:</span>
                  <span>{{ accountDetailsForm.get('username')?.value }}</span>
                </div>
              </div>

              <div class="review-section">
                <h5>Preferences</h5>
                <div class="review-item">
                  <span class="review-label">Language:</span>
                  <span>{{ preferencesForm.get('language')?.value }}</span>
                </div>
                <div class="review-item">
                  <span class="review-label">Timezone:</span>
                  <span>{{ preferencesForm.get('timezone')?.value }}</span>
                </div>
                <div class="review-item">
                  <span class="review-label">Notifications:</span>
                  <span>{{ preferencesForm.get('notifications')?.value }}</span>
                </div>
              </div>

              @if (!isFormComplete()) {
                <div class="validation-warning">
                  <amw-icon name="warning"></amw-icon>
                  <span>Please complete all previous steps before submitting</span>
                </div>
              }
            </div>
          </amw-tab>
        </amw-tabs>

        <!-- Navigation Buttons -->
        <div class="tab-navigation">
          <amw-button variant="elevated"
            (click)="previousStep()"
            [disabled]="selectedTabIndex === 0" icon="arrow_back" iconPosition="left">Previous</amw-button>

          @if (selectedTabIndex < 3) {
            <amw-button variant="elevated"
              color="primary"
              (click)="nextStep()"
              [disabled]="!canProceed()">
              Next
              <amw-icon name="arrow_forward"></amw-icon>
            </amw-button>
          } @else {
            <amw-button variant="elevated"
              color="primary"
              (click)="submitForm()"
              [disabled]="!isFormComplete()" icon="send" iconPosition="left">Submit</amw-button>
          }
        </div>

        <!-- Progress Indicator -->
        <div class="progress-indicator">
          <div class="progress-text">
            Step {{ selectedTabIndex + 1 }} of {{ steps.length }}
          </div>
          <div class="progress-steps">
            @for (step of steps; track step; let i = $index) {
              <div
                class="progress-step"
                [class.completed]="step.completed"
                [class.active]="i === selectedTabIndex"
                [class.error]="step.error"
                (click)="goToStep(i)">
              </div>
            }
          </div>
        </div>
      </ng-template>
</amw-card>
  </div>
</div>
