<div class="validation-section">
  <h3>Theme Configuration</h3>
  <p>Interactive theme builder with live preview and validation. Customize colors, mode, density, and typography.</p>

  <div class="validation-forms">
    <div class="theme-builder">
      <!-- Configuration Panel -->
      <amw-card class="validation-card config-panel">
        <ng-template #cardHeader>
          <h2>
            <mat-icon>palette</mat-icon>
            Theme Configuration
          </h2>
          <p class="subtitle">Customize your Material Design theme</p>
        </ng-template>
        <ng-template #cardContent>
          <form [formGroup]="themeForm">
            <!-- Color Configuration -->
            <div class="config-section">
              <h4>
                <mat-icon>color_lens</mat-icon>
                Color Palette
              </h4>

              <amw-input
                class="full-width"
                label="Primary Color"
                formControlName="primaryColor"
                type="color"
                placeholder="#6750a4">
              </amw-input>
              @if (themeForm.get('primaryColor')?.invalid && themeForm.get('primaryColor')?.touched) {
                <div class="field-error">{{ getErrorMessage('primaryColor') }}</div>
              }

              <amw-input
                class="full-width"
                label="Accent Color"
                formControlName="accentColor"
                type="color"
                placeholder="#625b71">
              </amw-input>
              @if (themeForm.get('accentColor')?.invalid && themeForm.get('accentColor')?.touched) {
                <div class="field-error">{{ getErrorMessage('accentColor') }}</div>
              }

              <amw-input
                class="full-width"
                label="Warn Color"
                formControlName="warnColor"
                type="color"
                placeholder="#ba1a1a">
              </amw-input>
              @if (themeForm.get('warnColor')?.invalid && themeForm.get('warnColor')?.touched) {
                <div class="field-error">{{ getErrorMessage('warnColor') }}</div>
              }
            </div>

            <!-- Mode Configuration -->
            <div class="config-section">
              <h4>
                <mat-icon>{{ getModeIcon() }}</mat-icon>
                Theme Mode
              </h4>

              <amw-radio-group formControlName="mode" class="mode-radio-group">
                <amw-radio value="light">
                  <mat-icon>light_mode</mat-icon>
                  Light Mode
                </amw-radio>
                <amw-radio value="dark">
                  <mat-icon>dark_mode</mat-icon>
                  Dark Mode
                </amw-radio>
              </amw-radio-group>
            </div>

            <!-- Density Configuration -->
            <div class="config-section">
              <h4>
                <mat-icon>height</mat-icon>
                Component Density
              </h4>

              <amw-select
                class="full-width"
                label="Density Level"
                formControlName="density">
                @for (option of densityOptions; track option.value) {
                  <mat-option [value]="option.value">
                    {{ option.name }} - {{ option.description }}
                  </mat-option>
                }
              </amw-select>
            </div>

            <!-- Typography Configuration -->
            <div class="config-section">
              <h4>
                <mat-icon>text_fields</mat-icon>
                Typography
              </h4>

              <amw-select
                class="full-width"
                label="Font Family"
                formControlName="typography">
                @for (option of typographyOptions; track option.value) {
                  <mat-option [value]="option.value">
                    {{ option.name }}
                  </mat-option>
                }
              </amw-select>
            </div>
          </form>

          <!-- Action Buttons -->
          <div class="config-actions">
            <amw-button variant="elevated"
              color="primary"
              (click)="applyTheme()"
              [disabled]="!isFormValid()" icon="check" iconPosition="left">Apply Theme</amw-button>

            <amw-button variant="elevated"
              (click)="resetTheme()" icon="refresh" iconPosition="left">Reset to Default</amw-button>

            <amw-button variant="elevated"
              (click)="exportTheme()"
              [disabled]="!isFormValid()" icon="download" iconPosition="left">Export Config</amw-button>
          </div>

          @if (!isFormValid()) {
            <div class="validation-warning">
              <mat-icon>warning</mat-icon>
              <span>Please fix validation errors before applying theme</span>
            </div>
          }
        </ng-template>
</amw-card>

      <!-- Preview Panel -->
      <amw-card class="validation-card preview-panel" [ngStyle]="getPreviewStyles()">
        <ng-template #cardHeader>
          <h2>
            <mat-icon>visibility</mat-icon>
            Preview
          </h2>
          <p class="subtitle">See your theme in action</p>
        </ng-template>
        <ng-template #cardContent>
          @if (previewEnabled()) {
            <div class="preview-content">
              <!-- Color Swatches -->
              <div class="color-swatches">
                <div class="swatch swatch--primary">
                  <div class="swatch-color"></div>
                  <span>Primary</span>
                </div>
                <div class="swatch swatch--accent">
                  <div class="swatch-color"></div>
                  <span>Accent</span>
                </div>
                <div class="swatch swatch--warn">
                  <div class="swatch-color"></div>
                  <span>Warn</span>
                </div>
              </div>

              <!-- Component Samples -->
              <div class="component-samples">
                <h5>Buttons</h5>
                <div class="button-group">
                  <amw-button variant="elevated" class="btn-primary">Primary</amw-button>
                  <amw-button variant="elevated" class="btn-accent">Accent</amw-button>
                  <amw-button variant="elevated" class="btn-warn">Warn</amw-button>
                </div>

                <h5>Text Styles</h5>
                <div class="text-samples">
                  <h6 class="sample-headline">Headline Text</h6>
                  <p class="sample-body">Body text with current theme applied.</p>
                  <span class="sample-caption">Caption text example</span>
                </div>

                <h5>Surface & Background</h5>
                <div class="surface-sample">
                  <div class="sample-card">
                    <div class="sample-card-header">Card Header</div>
                    <div class="sample-card-content">
                      This is a card with the current surface color applied.
                      The text adapts to the background for proper contrast.
                    </div>
                  </div>
                </div>

                <h5>Current Configuration</h5>
                <div class="config-summary">
                  <div class="summary-row">
                    <span class="label">Mode:</span>
                    <span class="value">{{ currentTheme().mode }}</span>
                  </div>
                  <div class="summary-row">
                    <span class="label">Density:</span>
                    <span class="value">{{ currentTheme().density }}</span>
                  </div>
                  <div class="summary-row">
                    <span class="label">Typography:</span>
                    <span class="value">{{ currentTheme().typography }}</span>
                  </div>
                </div>
              </div>
            </div>
          } @else {
            <div class="preview-disabled">
              <mat-icon>visibility_off</mat-icon>
              <p>Preview disabled</p>
              <amw-button variant="text" (click)="togglePreview()">Enable Preview</amw-button>
            </div>
          }
        </ng-template>
</amw-card>
    </div>
  </div>
</div>
