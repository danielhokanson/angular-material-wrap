<div class="validation-section">
  <h3>Form Validation Examples</h3>
  <p>Interactive forms demonstrating date picker validation, date range constraints, and error handling.</p>

  <div class="validation-forms">
    <!-- Basic Date Picker Form -->
    <mat-card class="validation-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>event</mat-icon>
          Basic Date Picker
        </mat-card-title>
        <mat-card-subtitle>Simple date selection with required validation</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <form [formGroup]="basicDateForm" (ngSubmit)="submitBasicDate()">
          <mat-form-field class="full-width" appearance="outline">
            <mat-label>Birth Date</mat-label>
            <input
              matInput
              [matDatepicker]="birthDatePicker"
              formControlName="birthDate"
              [max]="today"
              placeholder="MM/DD/YYYY" />
            <mat-datepicker-toggle matIconSuffix [for]="birthDatePicker"></mat-datepicker-toggle>
            <mat-datepicker #birthDatePicker></mat-datepicker>
            @if (basicDateForm.get('birthDate')?.invalid && basicDateForm.get('birthDate')?.touched) {
              <mat-error>{{ getErrorMessage(basicDateForm, 'birthDate') }}</mat-error>
            }
            <mat-hint>Select a date in the past</mat-hint>
          </mat-form-field>

          <div class="form-actions">
            <button
              mat-raised-button
              color="primary"
              type="submit"
              [disabled]="!isBasicDateValid()">
              <mat-icon>check</mat-icon>
              Submit
            </button>
          </div>
        </form>

        <div class="validation-status">
          @if (isBasicDateValid()) {
            <div class="status-message status-message--success">
              <mat-icon>check_circle</mat-icon>
              <span>Valid: Date selected</span>
            </div>
          } @else {
            <div class="status-message status-message--warning">
              <mat-icon>warning</mat-icon>
              <span>Select a birth date to continue</span>
            </div>
          }
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Date Range Form -->
    <mat-card class="validation-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>date_range</mat-icon>
          Date Range Selection
        </mat-card-title>
        <mat-card-subtitle>Start and end date with range validation</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <form [formGroup]="dateRangeForm" (ngSubmit)="submitDateRange()">
          <div class="date-range-fields">
            <mat-form-field appearance="outline" class="date-field">
              <mat-label>Start Date</mat-label>
              <input
                matInput
                [matDatepicker]="startDatePicker"
                formControlName="startDate"
                [min]="minDate"
                [max]="maxDate"
                placeholder="MM/DD/YYYY" />
              <mat-datepicker-toggle matIconSuffix [for]="startDatePicker"></mat-datepicker-toggle>
              <mat-datepicker #startDatePicker></mat-datepicker>
              @if (dateRangeForm.get('startDate')?.invalid && dateRangeForm.get('startDate')?.touched) {
                <mat-error>{{ getErrorMessage(dateRangeForm, 'startDate') }}</mat-error>
              }
            </mat-form-field>

            <mat-form-field appearance="outline" class="date-field">
              <mat-label>End Date</mat-label>
              <input
                matInput
                [matDatepicker]="endDatePicker"
                formControlName="endDate"
                [min]="minDate"
                [max]="maxDate"
                placeholder="MM/DD/YYYY" />
              <mat-datepicker-toggle matIconSuffix [for]="endDatePicker"></mat-datepicker-toggle>
              <mat-datepicker #endDatePicker></mat-datepicker>
              @if (dateRangeForm.get('endDate')?.invalid && dateRangeForm.get('endDate')?.touched) {
                <mat-error>{{ getErrorMessage(dateRangeForm, 'endDate') }}</mat-error>
              }
            </mat-form-field>
          </div>

          @if (getDateRangeError()) {
            <div class="range-error">
              <mat-icon>error</mat-icon>
              <span>{{ getDateRangeError() }}</span>
            </div>
          }

          <div class="form-actions">
            <button
              mat-raised-button
              color="primary"
              type="submit"
              [disabled]="!isDateRangeValid()">
              <mat-icon>check</mat-icon>
              Submit Range
            </button>
          </div>
        </form>

        <div class="validation-status">
          @if (isDateRangeValid()) {
            <div class="status-message status-message--success">
              <mat-icon>check_circle</mat-icon>
              <span>Valid: Date range selected</span>
            </div>
          }
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Event Booking Form -->
    <mat-card class="validation-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>event_available</mat-icon>
          Event Booking
        </mat-card-title>
        <mat-card-subtitle>Complex form with multiple date constraints</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <form [formGroup]="eventBookingForm" (ngSubmit)="submitEventBooking()">
          <mat-form-field class="full-width" appearance="outline">
            <mat-label>Event Name</mat-label>
            <input
              matInput
              formControlName="eventName"
              placeholder="Enter event name" />
            @if (eventBookingForm.get('eventName')?.invalid && eventBookingForm.get('eventName')?.touched) {
              <mat-error>{{ getErrorMessage(eventBookingForm, 'eventName') }}</mat-error>
            }
          </mat-form-field>

          <mat-form-field class="full-width" appearance="outline">
            <mat-label>Event Date</mat-label>
            <input
              matInput
              [matDatepicker]="eventDatePicker"
              formControlName="eventDate"
              [min]="minDate"
              [matDatepickerFilter]="weekendFilter"
              placeholder="MM/DD/YYYY" />
            <mat-datepicker-toggle matIconSuffix [for]="eventDatePicker"></mat-datepicker-toggle>
            <mat-datepicker #eventDatePicker></mat-datepicker>
            @if (eventBookingForm.get('eventDate')?.invalid && eventBookingForm.get('eventDate')?.touched) {
              <mat-error>{{ getErrorMessage(eventBookingForm, 'eventDate') }}</mat-error>
            }
            <mat-hint>Weekends only</mat-hint>
          </mat-form-field>

          <mat-form-field class="full-width" appearance="outline">
            <mat-label>Registration Deadline</mat-label>
            <input
              matInput
              [matDatepicker]="deadlinePicker"
              formControlName="registrationDeadline"
              [min]="minDate"
              [matDatepickerFilter]="weekdayFilter"
              placeholder="MM/DD/YYYY" />
            <mat-datepicker-toggle matIconSuffix [for]="deadlinePicker"></mat-datepicker-toggle>
            <mat-datepicker #deadlinePicker></mat-datepicker>
            @if (eventBookingForm.get('registrationDeadline')?.invalid && eventBookingForm.get('registrationDeadline')?.touched) {
              <mat-error>{{ getErrorMessage(eventBookingForm, 'registrationDeadline') }}</mat-error>
            }
            <mat-hint>Weekdays only, before event date</mat-hint>
          </mat-form-field>

          @if (getEventBookingError()) {
            <div class="range-error">
              <mat-icon>error</mat-icon>
              <span>{{ getEventBookingError() }}</span>
            </div>
          }

          <div class="form-actions">
            <button
              mat-raised-button
              color="primary"
              type="submit"
              [disabled]="!isEventBookingValid()">
              <mat-icon>send</mat-icon>
              Book Event
            </button>
          </div>
        </form>

        <div class="validation-status">
          @if (isEventBookingValid()) {
            <div class="status-message status-message--success">
              <mat-icon>check_circle</mat-icon>
              <span>Valid: Event booking ready to submit</span>
            </div>
          }
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Form Summary -->
    <mat-card class="validation-card validation-card--summary">
      <mat-card-content>
        <div class="form-summary">
          <h4>Validation Summary</h4>
          <div class="summary-items">
            <div class="summary-item">
              <mat-icon [class.valid]="isBasicDateValid()" [class.invalid]="!isBasicDateValid()">
                {{ isBasicDateValid() ? 'check_circle' : 'cancel' }}
              </mat-icon>
              <span>Basic Date Picker</span>
            </div>
            <div class="summary-item">
              <mat-icon [class.valid]="isDateRangeValid()" [class.invalid]="!isDateRangeValid()">
                {{ isDateRangeValid() ? 'check_circle' : 'cancel' }}
              </mat-icon>
              <span>Date Range Selection</span>
            </div>
            <div class="summary-item">
              <mat-icon [class.valid]="isEventBookingValid()" [class.invalid]="!isEventBookingValid()">
                {{ isEventBookingValid() ? 'check_circle' : 'cancel' }}
              </mat-icon>
              <span>Event Booking</span>
            </div>
          </div>
        </div>

        @if (!isBasicDateValid() || !isDateRangeValid() || !isEventBookingValid()) {
          <div class="summary-message">
            <mat-icon>info</mat-icon>
            <span>Complete all forms to see validation in action</span>
          </div>
        } @else {
          <div class="summary-message summary-message--success">
            <mat-icon>check_circle</mat-icon>
            <span>All forms are valid!</span>
          </div>
        }
      </mat-card-content>
    </mat-card>
  </div>
</div>
